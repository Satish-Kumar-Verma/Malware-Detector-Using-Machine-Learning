import psutil
from PyQt5.QtWidgets import QTableWidgetItem

def update_network_stats(table_widget):
    network_io = psutil.net_io_counters(pernic=True)
    table_widget.setRowCount(0)

    for interface, stats in network_io.items():
        row_position = table_widget.rowCount()
        table_widget.insertRow(row_position)

        table_widget.setItem(row_position, 0, QTableWidgetItem(interface))
        table_widget.setItem(row_position, 1, QTableWidgetItem(f"{stats.bytes_sent / 1024 / 1024:.2f} MB"))
        table_widget.setItem(row_position, 2, QTableWidgetItem(f"{stats.bytes_recv / 1024 / 1024:.2f} MB"))
        table_widget.setItem(row_position, 3, QTableWidgetItem(f"{stats.packets_sent}"))
        table_widget.setItem(row_position, 4, QTableWidgetItem(f"{stats.packets_recv}"))
        table_widget.setItem(row_position, 5, QTableWidgetItem(f"{stats.errin}"))
        table_widget.setItem(row_position, 6, QTableWidgetItem(f"{stats.errout}"))
        table_widget.setItem(row_position, 7, QTableWidgetItem(f"{stats.dropin}"))
        table_widget.setItem(row_position, 8, QTableWidgetItem(f"{stats.dropout}"))
